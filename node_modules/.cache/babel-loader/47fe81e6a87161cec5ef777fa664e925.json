{"ast":null,"code":"var _jsxFileName = \"/Users/ioanalexandrumuresan/Desktop/DS/DS2022_30442_Muresan_Ioan-Alexandru_Assignment_1_frontend/src/User/UserChat.js\",\n  _s = $RefreshSig$();\nimport axios from \"axios\";\nimport React, { useEffect, useState } from \"react\";\nimport * as SockJS from \"sockjs-client\";\nimport * as Stomp from \"stompjs\";\nimport './User.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar stompClient = null;\nvar user = localStorage.getItem(\"user\");\nfunction connect(userName) {\n  console.log(\"we will connect to \" + userName);\n  const user = localStorage.getItem(\"user\");\n  var socket = new SockJS(\"http://127.0.0.1:8080/ws\");\n  stompClient = Stomp.over(socket);\n  if (userName) {\n    stompClient.connect({}, function (frame) {\n      console.log(\"Connected for messaging: \" + frame);\n      stompClient.subscribe(\"/all/specific\", function (message) {\n        setUnreadMess(true);\n        console.log(message);\n        displayMess(JSON.parse(message.body), userName);\n      });\n    });\n  }\n}\nfunction displayMess(warningMessage, userName) {\n  console.log(warningMessage);\n  var mess = document.getElementById(\"messageDiv\");\n  var pName = document.createElement(\"p\");\n  pName.id = \"userFrom\";\n  var p = document.createElement(\"p\");\n  p.id = \"message\";\n  mess.appendChild(pName);\n  mess.appendChild(p);\n  pName.appendChild(document.createTextNode(\"From user: \" + warningMessage.userFrom));\n  p.appendChild(document.createTextNode(\" \" + \"Dear user called \" + userName + \": \" + warningMessage.text));\n}\nfunction disconnect() {\n  if (stompClient != null) {\n    stompClient.disconnect();\n    stompClient = null;\n  }\n  console.log(\"Disconnected\");\n}\nfunction UserChat(_ref) {\n  _s();\n  let {\n    userName\n  } = _ref;\n  //console.log(\"The user we got is:\" + userName);\n\n  const [unreadMess, setUnreadMess] = useState(false);\n  const typingMessage = e => {\n    var nr = e.target.value;\n    let nrREG = new RegExp('^.{20,}$');\n    var recipient = document.getElementById(\"userTo\").value;\n    if (nr > 0) stompClient.send('/app/application', {}, JSON.stringify({\n      userFrom: user,\n      userTo: recipient,\n      text: \"I am typing my response\"\n    }));\n    ; //aici trimitem mesajul cu typing\n  };\n\n  function sendRead(unreadMess) {\n    var recipient = document.getElementById(\"userTo\").value;\n    if (unreadMess) {\n      stompClient.send('/app/application', {}, JSON.stringify({\n        userFrom: user,\n        userTo: recipient,\n        text: \"message has been read\"\n      })); //aici se trimite mesajul de read\n      setUnreadMess(false);\n    }\n  }\n  const sendMessage = async e => {\n    e.preventDefault();\n\n    //aici se trimite mesajul prorpiu-zis, la admin sau user\n    var message = document.getElementById(\"chatBox\").value;\n    var recipient = document.getElementById(\"userTo\").value;\n    stompClient.send('/app/application', {}, JSON.stringify({\n      userFrom: user,\n      userTo: recipient,\n      text: message\n    }));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"messageDiv\",\n      children: \"Chat:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      id: \"connect\",\n      onClick: () => connect(userName),\n      children: \"Connect\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      id: \"disconnect\",\n      onClick: () => {\n        disconnect();\n      },\n      children: \"Disconnect\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      children: \"Insert message here:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      onChange: e => typingMessage(e),\n      type: \"text\",\n      id: \"chatBox\",\n      onClick: sendRead(unreadMess)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      children: \"Insert user to send to:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      id: \"userTo\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: sendMessage,\n      children: \"Send Message\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 9\n  }, this);\n}\n_s(UserChat, \"7PC/2tUrUcSkPM+BOGYo3S1EIQk=\");\n_c = UserChat;\nexport default UserChat;\nvar _c;\n$RefreshReg$(_c, \"UserChat\");","map":{"version":3,"names":["axios","React","useEffect","useState","SockJS","Stomp","stompClient","user","localStorage","getItem","connect","userName","console","log","socket","over","frame","subscribe","message","setUnreadMess","displayMess","JSON","parse","body","warningMessage","mess","document","getElementById","pName","createElement","id","p","appendChild","createTextNode","userFrom","text","disconnect","UserChat","unreadMess","typingMessage","e","nr","target","value","nrREG","RegExp","recipient","send","stringify","userTo","sendRead","sendMessage","preventDefault"],"sources":["/Users/ioanalexandrumuresan/Desktop/DS/DS2022_30442_Muresan_Ioan-Alexandru_Assignment_1_frontend/src/User/UserChat.js"],"sourcesContent":["import axios from \"axios\";\nimport React, {useEffect, useState} from \"react\";\nimport * as SockJS from \"sockjs-client\";\nimport * as Stomp from \"stompjs\";\nimport './User.css';\n\nvar stompClient = null;\nvar user = localStorage.getItem(\"user\");\n\n\nfunction connect(userName) {\n    console.log(\"we will connect to \" + userName);\n  const user = localStorage.getItem(\"user\");\n  var socket = new SockJS(\"http://127.0.0.1:8080/ws\");\n  stompClient = Stomp.over(socket);\n  if (userName) {\n    stompClient.connect({}, function(frame) {\n      console.log(\"Connected for messaging: \" + frame);\n      stompClient.subscribe(\"/all/specific\", function(\n        message\n      ) {\n        setUnreadMess(true);\n        console.log(message);\n        displayMess(JSON.parse(message.body), userName);\n      });\n    });\n  }\n}\n\nfunction displayMess(warningMessage, userName) {\n  console.log(warningMessage);\n  var mess = document.getElementById(\"messageDiv\");\n  var pName = document.createElement(\"p\");\n  pName.id = \"userFrom\"\n  var p = document.createElement(\"p\");\n  p.id = \"message\"\n  mess.appendChild(pName);\n  mess.appendChild(p);\n\n  pName.appendChild(\n    document.createTextNode(\n        \"From user: \" + warningMessage.userFrom\n    )\n  );\n\n  p.appendChild(\n    document.createTextNode(\n        \" \" +\n        \"Dear user called \" + userName +\n        \": \" +\n        warningMessage.text\n    )\n  );\n}\n\nfunction disconnect() {\n  if (stompClient != null) {\n    stompClient.disconnect();\n    stompClient = null;\n  }\n  console.log(\"Disconnected\");\n}\n\nfunction UserChat({userName}) {\n    //console.log(\"The user we got is:\" + userName);\n\n    const [unreadMess, setUnreadMess] = useState(false)\n\n    const typingMessage = (e) => {\n        var nr = e.target.value\n        let nrREG = new RegExp('^.{20,}$')\n        var recipient = document.getElementById(\"userTo\").value;\n        if(nr > 0)\n            stompClient.send('/app/application', {}, JSON.stringify({userFrom:user, userTo:recipient, text:\"I am typing my response\"})); ; //aici trimitem mesajul cu typing\n    }\n\n    function sendRead(unreadMess) {\n\n        var recipient = document.getElementById(\"userTo\").value;\n    \n        if (unreadMess) {\n            stompClient.send('/app/application', {}, JSON.stringify({userFrom:user, userTo:recipient, text:\"message has been read\"}));   //aici se trimite mesajul de read\n            setUnreadMess(false);\n        }\n    \n    }\n\n    const sendMessage = async e => {\n        e.preventDefault();\n        \n        //aici se trimite mesajul prorpiu-zis, la admin sau user\n        var message = document.getElementById(\"chatBox\").value;\n        var recipient = document.getElementById(\"userTo\").value;\n\n        stompClient.send('/app/application', {}, JSON.stringify({userFrom:user, userTo:recipient, text:message}))\n    }\n\n    return ( \n        <div>\n            <div id=\"messageDiv\">Chat:</div>\n                <button id=\"connect\" onClick={() => connect(userName)}>\n                    Connect\n                </button>\n                <br></br>\n                <button id=\"disconnect\" onClick={() => {disconnect();}}>\n                    Disconnect\n                </button>\n                <br></br>\n            \n            <label>Insert message here:</label>\n            <br></br>\n            <input onChange={(e) => typingMessage(e)} type='text' id=\"chatBox\" onClick={sendRead(unreadMess)}></input>\n            <br></br>\n            <label>Insert user to send to:</label>\n            <br></br>\n            <input type='text' id=\"userTo\"></input>\n            <button onClick={sendMessage}>Send Message</button>\n        </div>\n    )\n}\n\nexport default UserChat;"],"mappings":"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"},"metadata":{},"sourceType":"module"}